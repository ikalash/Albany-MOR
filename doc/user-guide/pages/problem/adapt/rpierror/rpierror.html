<html>
  
  <head>
    <script type="text/javascript" src="../../../../common/js/cm.js"></script>
    <link rel="stylesheet" href="../../../../common/css/style.css" type="text/css">
  </head>

  <body>
    <center>
      <h2>Adaptation - RPI Error Size</h2>
      <a href="#description">Description</a>&emsp;
      <a href="#dependencies">Dependencies</a>&emsp;
      <a href="#parameters">Parameters</a>&emsp;
      <a href="#example">Example</a>&emsp;
      <a href="#albanyexs">Albany Examples</a>&emsp;
      <a href="#results">Results</a>
    </center>

    <hr>

    <h3><a name="description">Description</h3>
    
    <p>
      THIS ROUTINE WILL WORK FOR LINEAR TETS ONLY
    </p>
    <p>
      At a given iteration step, elemental strains in the mesh are computed
      based on nodal displacements. For each node in the mesh, a new strain
      computed from a volume-weighted average of the strains for the elements
      adjacent to the node is computed. An elemental error is then computed 
      by taking the difference of this new strain with old elemental strains.
      A new mesh size field is then computed at vertices from these elemental 
      errors.
    </p>

    <h3><a name="dependencies">Dependencies</h3>
    SCOREC
    
    <h3><a name="parameters">Parameters</h3>
    <ul>
      <li>Max Number of Mesh Adapt Iterations
	<ul>
	  <li>Data Type</li>
	  &emsp; &lt;int&gt;
	  <li>Default Value</li>
	  &emsp; 1
	  <li>Description</li>
	  &emsp; "Number of iterations to limit meshadapt to"
	</ul>
      </li>
      <li>Remesh Step Number
	<ul>
	  <li>Data Type</li>
	  &emsp; &lt;int&gt;
	  <li>Default Value</li>
	  &emsp; 1
	  <li>Description</li>
	  &emsp; "Iteration step at which to remesh the problem"
	</ul>
      </li>
    </ul>
    
    <h3><a name="example">Example</h3>
    <pre>
&lt;ParameterList&gt;
  &lt;ParameterList name="Problem"&gt;
    &lt;ParameterList name="Adaptation"&gt;
      &lt;Parameter name="Method" type="string" value="RPI Unif Size"/&gt;
      &lt;Parameter name="Remesh Step Number" type="int" value="5"/&gt;
      &lt;Parameter name="Max Number of Mesh Adapt Iterations" type="int" value="10"/&gt;
    &lt;/ParameterList&gt;
  &lt;/ParameterList&gt;
&lt;/ParameterList&gt;
    </pre>
    
    <h3><a name="albanyexs">Albany Examples</h3>
    <ul>
      <li>Albany/examples/ErrorBasedAdapt3D/input-elasticity.xml</li>
      <li>Albany/examples/ErrorBasedAdapt3D/input-plasticity.xml</li>
      <li>Albany/examples/ErrorBasedAdapt3D/inputCoarseML.xml</li>
      <li>Albany/examples/ErrorBasedAdapt3D/inputElastML.xml</li>
    </ul>
    

    <h3><a name="results">Results</h3>
    <img src="initial.png" width="300px">
    <img src="adapted.png" width="300px">
    
  </body>
</html>
